import{Q as m,b,c as w,d as P}from"./QItem.8e917815.js";import{c as U,d as z}from"./index.416c10b7.js";import{Q as _,h as T}from"./QPagination.6eb9fd1c.js";import{Q as f,R as B}from"./QBtn.e5691bad.js";import{Q as $}from"./QCircularProgress.04fad857.js";import{S as g}from"./api.9fab9f7e.js";import{d as N}from"./dayjs.min.96389700.js";import{r as D}from"./relativeTime.c4fed282.js";import{H as F,c as V,I as a,J as l,K as t,d as s,U as i,L as M,M as c,N as p,P as k,r as Q,w as x,o as j,k as E,Q as v,F as H,R as J,A}from"./index.02176f2b.js";const K={class:"text-weight-medium"},W={class:"text-grey-8 q-gutter-xs"},G=F({__name:"TrackedRunListItem",props:{trackedRun:null},setup(y){const e=y;N.extend(D);const h=V(()=>N().to(e.trackedRun.created_at)),u=V(()=>{let d=1,o=e.trackedRun;for(;o.parent!==null;)o=o.parent,d++;return d});return(d,o)=>(a(),l(w,{clickable:"",to:{path:"/run/"+e.trackedRun.id}},{default:t(()=>[s(m,{avatar:"",top:""},{default:t(()=>[e.trackedRun.status===i(g).Queued?(a(),l(f,{key:0,name:"hourglass_top",color:"black",size:"34px"})):e.trackedRun.status===i(g).Started?(a(),l($,{key:1,"show-value":"",value:e.trackedRun.percentage,rounded:"",size:"34px",class:"q-ma-md"},null,8,["value"])):e.trackedRun.status===i(g).Succeeded?(a(),l(f,{key:2,name:"done",color:"black",size:"34px"})):e.trackedRun.status===i(g).Failed?(a(),l(f,{key:3,name:"close",color:"black",size:"34px"})):e.trackedRun.status===i(g).Cancelled?(a(),l(f,{key:4,name:"not_interested",color:"black",size:"34px"})):M("",!0)]),_:1}),s(m,{top:"",class:"col-2 gt-sm"},{default:t(()=>[s(b,{class:"q-mt-sm"},{default:t(()=>[c(p(i(h)),1)]),_:1})]),_:1}),s(m,{top:""},{default:t(()=>[s(b,{lines:"1"},{default:t(()=>[k("span",K,p(e.trackedRun.status),1)]),_:1}),s(b,{caption:""},{default:t(()=>[k("span",null,[e.trackedRun.messages.length===0?(a(),l(_,{key:0,dense:"",icon:"chat"},{default:t(()=>[c("Messages: "+p(e.trackedRun.messages.length),1)]),_:1})):(a(),l(_,{key:1,dense:"",color:"blue","text-color":"white",icon:"chat"},{default:t(()=>[c(" Messages: "+p(e.trackedRun.messages.length),1)]),_:1}))]),k("span",null,[e.trackedRun.signals.length===0?(a(),l(_,{key:0,dense:"",icon:"sensors"},{default:t(()=>[c("Signals: "+p(e.trackedRun.signals.length),1)]),_:1})):(a(),l(_,{key:1,dense:"",color:"red","text-color":"white",icon:"sensors"},{default:t(()=>[c(" Signals: "+p(e.trackedRun.signals.length),1)]),_:1}))]),k("span",null,[i(u)===1?(a(),l(_,{key:0,dense:"",icon:"replay"},{default:t(()=>[c("Retries: "+p(i(u)-1),1)]),_:1})):(a(),l(_,{key:1,dense:"",color:"orange","text-color":"white",icon:"replay"},{default:t(()=>[c(" Retries: "+p(i(u)-1),1)]),_:1}))])]),_:1})]),_:1}),s(m,{top:"",side:""},{default:t(()=>[k("div",W,[s(f,{class:"gt-xs",size:"12px",icon:"keyboard_arrow_right"})])]),_:1})]),_:1},8,["to"]))}}),O={key:0},X={class:"q-pa-lg flex flex-center"},Y={key:1},Z={key:2},ce=F({__name:"RunListWithFiltering",props:{queues:null,aliases:null,batchIds:null,title:null},setup(y){const e=y,h=Q(1);x(h,(r,n)=>{o()});const u=Q(null),d=Q(null);x(()=>e.queues,(r,n)=>o()),x(()=>e.aliases,(r,n)=>o()),x(()=>e.batchIds,(r,n)=>o());function o(){d.value!==null&&d.value.stop();let r=U.runs.search();if(e.aliases!==void 0)for(let n of e.aliases)r=r.whereAlias(n);if(e.batchIds!==void 0)for(let n of e.batchIds)r=r.whereBatchId(n);if(e.queues!==void 0)for(let n of e.queues)r=r.whereQueue(n);d.value=r.page(h.value).bypassAuth().listen().onUpdated(n=>u.value=n).start()}return j(()=>o()),E(()=>{d.value!==null&&d.value.stop()}),(r,n)=>(a(),l(P,{bordered:"",class:"rounded-borders",style:{"min-width":"85%"}},{default:t(()=>{var q,I,S,L,C;return[s(b,{header:""},{default:t(()=>[c(p(y.title),1)]),_:1}),((q=u.value)==null?void 0:q.total)>0?(a(),v("div",O,[s(z),(a(!0),v(H,null,J((S=(I=u.value)==null?void 0:I.data)!=null?S:[],R=>(a(),v("div",{key:R.id},[s(G,{"tracked-run":R},null,8,["tracked-run"]),s(z)]))),128)),k("div",X,[((L=u.value)==null?void 0:L.total)>0?(a(),l(T,{key:0,input:"","model-value":u.value.current_page,"onUpdate:modelValue":n[0]||(n[0]=R=>h.value=R),max:u.value.last_page},null,8,["model-value","max"])):M("",!0)])])):((C=u.value)==null?void 0:C.total)===0?(a(),v("div",Y,[A((a(),l(w,{clickable:""},{default:t(()=>[s(m,{avatar:""},{default:t(()=>[s(f,{color:"negative",name:"warning"})]),_:1}),s(m,null,{default:t(()=>[c("No runs found")]),_:1})]),_:1})),[[B]])])):(a(),v("div",Z,[A((a(),l(w,{clickable:""},{default:t(()=>[s(m,{avatar:""},{default:t(()=>[s(f,{color:"primary",name:"sync"})]),_:1}),s(m,null,{default:t(()=>[c("Loading")]),_:1})]),_:1})),[[B]])]))]}),_:1}))}});export{ce as _};
